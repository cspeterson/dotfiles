auto_view 'text/*' # Automatically view these attachments in the pager

ignore * # When displaying mail in pager. ignore all headers...
unignore from date subject to cc # But unignore *these* headers

set attach_save_dir = "~/downloads/" # Default save dir for attachments to XDG downloads
set collapse_all # Fold all threads
set copy = 'yes'
set delete = 'yes' # Delete without prompting
set header_cache = "~/.cache/mutt" # Point to a directory for better performance
set forward_format = 'Fwd: %s' # Prepend indicator to a forwarded message like every other client because the default disagrees
set imap_passive = 'no' # Let NeoMutt create new IMAP connections
set index_format="\
%4C \
%Z \
%?[d?ðŸ“…&  ? \
%{%a %Y.%m.%dT%H:%M} \
%-17.17L \
%?M?ðŸ§µ&  ? \
%s"
set mail_check = 90 # Auto refresh 90s
set mail_check_stats
set mail_check_stats_interval = 60
set mailcap_path = "~/.config/neomutt/mailcap" # MIME type handling
set message_cachedir = "~/.cache/mutt"
set postpone = 'yes' # Always save unfinished messages to drafts
set realname = 'Christopher Peterson' # It'sa me
set resolve = 'no' # Do not skip to next message after an action is taken
set resume_draft_files = 'yes' # Draftsa as postponed
set sidebar_format = "%B%?F? [%F]?%* %?N?%N/?%S"
set sidebar_visible
set sort='reverse-threads' # New on top
set strict_threads = 'no' # Play loose with figuring out what counts as part of a threaded conversation
set timeout=30 # For timeout on *user input*

# A design limitation in NeoMutt means that binding e.g. both `n` and `nn` is
# problematic - unbind the shorter ones to sidestep
unbind generic z
unbind index,pager d
unbind attach,browser,index,pager g

# Bindings/macros
bind  attach,browser,index               G         last-entry # Jump to bottom
bind  attach,browser,index               gg        first-entry # Jump to top
bind  attach,browser,index,pager         \Cb       previous-page # Scroll pageup
bind  attach,browser,index,pager         \Cf       next-page # Scroll pagedown
bind  browser,index,pager                N         search-opposite # As `N` in Vim search
bind  editor                             \t        complete-query # Tab-completion
bind  generic                            zz         current-middle # Vim-ish centering of current line
bind  index                              <Down>    next-entry # Select next item, even if marked for deletion
bind  index                              <Up>      previous-entry # Select prev item, even if marked for deletion
bind  index                              <space>   collapse-thread # Toggle folding of the selected thread
bind  index                              D         undelete-message
bind  index                              \\r       imap-fetch-mail
bind  index                              \\s       sync-mailbox
bind  index                              dt        delete-thread # Mark thread for deletion but do not push changes
bind  index                              g!        flag-message
bind  index                              gT        untag-pattern
bind  index                              gt        tag-pattern
bind  index                              x         delete-message # Mark message for deletion but do not push the change
bind  index                              zA        collapse-all # Toggle folding current thread
bind  index                              za        collapse-all # Toggle folding current thread
bind  index,pager                        <C-Down>  sidebar-next
bind  index,pager                        <C-Right> sidebar-open
bind  index,pager                        <C-Up>    sidebar-prev
bind  index,pager                        X         undelete-message
bind  pager                              <Down>    next-line # Scroll
bind  pager                              <Up>      previous-line # Scroll
bind  pager                              G         bottom # Jump to bottom
bind  pager                              gg        top # Jump to top
bind  pager                              j         next-line # Scroll
bind  pager                              k         previous-line # Scroll
bind index,pager                         gr        group-reply
bind pager                               <Left>    previous-entry # In pager, left/right skip prev/next
bind pager                               <Right>   next-entry # In pager, left/right skip prev/next
macro attach                            \co        '<enter-command>set mailcap_path="~/.config/neomutt/mailcap.xdgall"<Enter><view-attach><enter-command>set mailcap_path="~/.config/neomutt/mailcap"<Enter>' # Open the selected attachment via xdg-open, ignoring any other configured handling
macro attach,compose,index,compose,pager \cu       '<pipe-entry> urlscan<Enter>' 'Call urlscan to extract URLs out of a message'
macro generic                            <F5>      '<enter-command>source ~/.config/neomutt/muttrc<Enter>' # Refresh main config (but not account-specific)
macro index                              dT        '<delete-thread> <sync-mailbox>' # Immediately force deletion of current message and go back to listing
macro index                              dd        '<delete-message> <sync-mailbox>' # Delete and immediately push the change
macro index,pager                        <C-Left>  "<change-folder>+INBOX<enter>"
macro pager                              dT        '<delete-thread> <sync-mailbox> <exit>' # Immediately force deletion of current message and go back to listing
macro pager                              dd        '<delete-message> <sync-mailbox> <exit>' # Delete message being viewed and go back to index
macro pager                              dt        '<delete-thread> <exit>' # Mark thread for deletion but do not push changes
macro pager                              x         '<delete-message> <exit>' # Mark message being viewed for deletion and hop back to index
